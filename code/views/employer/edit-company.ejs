<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Page Title -->
    <title>Edit Company's Infomation</title>
</head>
<body>
<div class="page-title page-title-blog text-center" style="background-image: url('<%- company.logo %>')">
    <div class="container">
        <div class="row">
            <div class="col-md-6 offset-md-3">
                <h2><%- company.name %></h2>
            </div>
        </div>
    </div>
</div>
<section class="edit-area section-padding">
    <div class="container">
        <div class="row">
            <div class="col-lg post-list blog-post-list">
                <div class="single-widget" id="edit-profile">
                    <form method="post" id="edit-profile-form">
                        <h3 class="mb-3">Thông tin công ty</h3>
                        <table class="table table-borderless">
                            <tbody>
                            <tr>
                                <th class="align-middle" scope="row"><i class="fas fa-user"></i> Name</th>
                                <td><input type="text" name="name" placeholder="name" class="form-control"
                                           value="<%- company.name %>" required></td>
                            </tr>
                            <tr>
                                <th class="align-middle" scope="row"><i class="fas fa-map-marker-alt"></i> Address</th>
                                <td><input type="text" name="address" placeholder="address" class="form-control"
                                           value="<%- company.address %>" required></td>
                            </tr>
                            <tr>
                                <th class="align-middle" scope="row"><i class="fas fa-mobile-alt"></i> Phone</th>
                                <td><input type="text" name="phone" placeholder="phone" class="form-control"
                                           value="<%- company.phone %>" required></td>
                            </tr>
                            <tr>
                                <th class="align-middle" scope="row"><i class="fas fa-envelope-open-text"></i> Email
                                </th>
                                <td><input type="text" name="email" placeholder="email" class="form-control"
                                           value="<%- company.email %>"></td>
                            </tr>
                            <tr>
                                <th class="align-middle" scope="row"><i class="fas fa-map-marker-alt"></i> Manager's
                                    password
                                </th>
                                <td><input type="password" name="current_password" placeholder="current password"
                                           class="form-control"
                                           required>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                        <div class="job-btn text-center">
                            <input id="btn-update-profile" name="edit_profile" type="submit"
                                   class="btn genric-btn info "
                                   value="UPDATE">
                        </div>
                    </form>
                </div>
                <div class="single-widget" id="edit-description">
                    <h3>Giới thiệu:</h3>
                    <div class="single-content2">
                    </div>
                    <form method="post" id="edit-description-form">
                        <div class="form-group">
                            <label for="description">Nội dung</label>
                            <textarea class="form-control" id="description" name="description"><%- company.description %></textarea>
                        </div>
                        <div class="job-btn text-center form-group">
                            <input id="btn-update-description" name="edit_description" type="submit"
                                   class="btn genric-btn info "
                                   value="UPDATE">
                        </div>
                    </form>
                </div>
                <div class="single-widget" id="upload-image">
                    <h3>Hình ảnh công ty:</h3>
                    <div class="company-review-logo">
                        <img src="<%- company.logo %>">
                    </div>
                    <div class="row d-flex justify-content-center align-self-center mb-5">
                        <%- include('../elements/upload-image-form') %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.3/js/fileinput.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-fileinput/5.0.3/themes/fa/theme.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.0/jquery.validate.min.js"></script>
<script src="https://cloud.tinymce.com/5/tinymce.min.js?apiKey=ezd73nxbzc7bu6e86g2l82jbbffke0mwevwrnyvc5q8h89j6"></script>
<script>
    tinymce.init({
        selector: '#description',
        height: 500,
        menubar: false,
        plugins: 'paste image link autolink lists table media wordcount fullscreen',
        toolbar: [
            'styleselect',
            'undo redo | bold italic underline strikethrough | numlist bullist | alignleft aligncenter alignright',
            'forecolor backcolor',
            'table link image media',
            'fullscreen'
        ],
    });

    $("#image-input").fileinput({
        theme: 'fa',
        dropZoneEnabled: false,
        uploadUrl: '/company/upload-image',
        uploadAsync: false,
        overwriteInitial: true,
        maxFileSize: 5000,
        showClose: false,
        showCaption: false,
        browseLabel: '',
        removeLabel: '',
        browseIcon: '<i class="fas fa-folder-open"></i>',
        removeIcon: '<i class="fas fa-trash"></i>',
        removeTitle: 'Cancel or reset changes',
        elErrorContainer: '#kv-avatar-errors-1',
        msgErrorClass: 'alert alert-block alert-danger',
        defaultPreviewContent: '<img class="avatar" src="/images/avatar/profile-placeholder.png" alt="Your Avatar">',
        layoutTemplates: {main2: '{preview} ' + '{upload}' + ' {remove} {browse}'},
        allowedFileExtensions: ["jpg", "png", "gif"]
    });
    $('#edit-profile-form').validate({
        rules: {
            name: {
                required: true,
            },
            address: {
                required: true,
            },
            email: {
                required: true,
                email: true,
            },
            phone: {
                number: true
            },
            current_password: {
                required: true,
                remote: {
                    url: '/my-company/edit/verify-pass'
                }
            },
        },
        messages: {
            name: {
                required: 'Name is required.',
            },
            address: {
                required: 'Invalid address',
            },
            phone: {
                number: "Phone must be number"
            },
            email: {
                required: 'Invalid email address.',
                email: 'Invalid email address.',
            },
            current_password: {
                required: 'Current password is required.',
                remote: "Current password does not match"
            },
        },
        errorElement: 'small',
        errorClass: 'help-block text-warning',
        highlight: function (e) {
            $(e).removeClass('is-valid').addClass('is-invalid');
        },
        unhighlight: function (e) {
            $(e).removeClass('is-invalid').addClass('is-valid');
        }
    });
</script>
</html>
